/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package cvatonpostgres;

import java.awt.Color;
import java.awt.Component;
import java.awt.Dimension;
import java.awt.GridBagLayout;

import java.awt.event.MouseEvent;
import java.sql.Array;
import java.sql.Connection;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.Collection;
import java.util.List;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.JTable;
import javax.swing.table.TableCellRenderer;
import javax.swing.table.TableColumn;
import javax.swing.table.TableRowSorter;
import java.util.Vector;
import javax.swing.BorderFactory;

/**
 *
 * @author Keith Harryman
 */
public class CvatJFrame extends javax.swing.JFrame {

    static private JPanel myListedPanel;
    static public JFrame cvatJFrame;
    static public CvatJFrame myFrame;
    ResultSetTableModel bolsTableModel = null, bolVehiclesTableModel = null, driversTableModel, trailersTableModel;
    TableRowSorter sorter = null;
    TableCellRenderer defaultRenderer;
    CellRenderer cellRenderer;
    List<String> bolsLoaded;
    List<List<String>> vehiclesLoaded;
    static public String selectedTable = "bolsTable";
    static public int selectedBOLIndex;
    private int selectedBOLRow = -1;
    static public boolean canGetValue = true, bolsTableReady = false;
    public int loadedVehiclesNextIndex = 0;

    /**
     * Creates new form CvatJFrame
     */
    public CvatJFrame() {
        cvatJFrame = this;
        myFrame = this;
        cellRenderer = new CellRenderer();
        initComponents();
        cvatJFrame.setExtendedState(cvatJFrame.getExtendedState() | JFrame.MAXIMIZED_BOTH);        
        //cvatJFrame.setSize(new Dimension(1700, 600));
        bolsLoaded = new ArrayList<String>();
        vehiclesLoaded = new ArrayList<List<String>>();
        selectedBOLIndex = 0;
        loadDrivers();
        loadTrailers();
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jTabbedPane1 = new javax.swing.JTabbedPane();
        jLabel1 = new javax.swing.JLabel();
        jTabbedPane2 = new javax.swing.JTabbedPane();
        jTabbedPane5 = new javax.swing.JTabbedPane();
        ListedPanel = new javax.swing.JPanel();
        jLabel2 = new javax.swing.JLabel();
        getListedBOLs = new javax.swing.JButton();
        jScrollPane1 = new javax.swing.JScrollPane();
        bolsTable = new javax.swing.JTable();
        selectFromRegion = new javax.swing.JComboBox<>();
        selectToRegion = new javax.swing.JComboBox<>();
        jScrollPane5 = new javax.swing.JScrollPane();
        loadedVehiclesTable = new javax.swing.JTable();
        jLabel7 = new javax.swing.JLabel();
        jLabel8 = new javax.swing.JLabel();
        jLabel9 = new javax.swing.JLabel();
        jLabel10 = new javax.swing.JLabel();
        selectedDriver = new javax.swing.JComboBox<>();
        jLabel12 = new javax.swing.JLabel();
        loadOut = new javax.swing.JButton();
        jLabel4 = new javax.swing.JLabel();
        selectedTrailer = new javax.swing.JComboBox<>();
        jScrollPane2 = new javax.swing.JScrollPane();
        trailersTable = new javax.swing.JTable();
        jScrollPane3 = new javax.swing.JScrollPane();
        driversTable = new javax.swing.JTable();
        jScrollPane7 = new javax.swing.JScrollPane();
        bolVehiclesTable = new javax.swing.JTable();
        jLabel3 = new javax.swing.JLabel();
        BOLPanel = new javax.swing.JPanel();
        jLabel6 = new javax.swing.JLabel();
        jScrollPane4 = new javax.swing.JScrollPane();
        jTable4 = new javax.swing.JTable();
        isActiveBOLs = new javax.swing.JCheckBox();
        jLabel11 = new javax.swing.JLabel();
        jScrollPane6 = new javax.swing.JScrollPane();
        jTable6 = new javax.swing.JTable();
        getPastBOLVehicles = new javax.swing.JButton();
        ExportImportPanel = new javax.swing.JPanel();

        jLabel1.setText("jLabel1");

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);

        ListedPanel.setFont(new java.awt.Font("Tahoma", 1, 18)); // NOI18N
        ListedPanel.setMaximumSize(getSize());

        jLabel2.setFont(new java.awt.Font("Tahoma", 0, 24)); // NOI18N
        jLabel2.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        jLabel2.setText("LISTED VEHICLES");

        getListedBOLs.setFont(new java.awt.Font("Times New Roman", 1, 18)); // NOI18N
        getListedBOLs.setText("Get and Group Orders By Location");
        getListedBOLs.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                getListedBOLsActionPerformed(evt);
            }
        });

        bolsTable.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null, null, null},
                {null, null, null, null, null, null},
                {null, null, null, null, null, null}
            },
            new String [] {
                "LOAD/UNLOAD", "From Name", "From Address", "To Name", "To Address", "# Vehicles"
            }
        ) {
            Class[] types = new Class [] {
                java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class
            };
            boolean[] canEdit = new boolean [] {
                false, false, false, false, true, true
            };

            public Class getColumnClass(int columnIndex) {
                return types [columnIndex];
            }

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        bolsTable.setColumnSelectionAllowed(true);
        bolsTable.setIntercellSpacing(new java.awt.Dimension(0, 0));
        bolsTable.getTableHeader().setReorderingAllowed(false);
        bolsTable.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                bolsTableMouseClicked(evt);
            }
        });
        jScrollPane1.setViewportView(bolsTable);
        bolsTable.getColumnModel().getSelectionModel().setSelectionMode(javax.swing.ListSelectionModel.MULTIPLE_INTERVAL_SELECTION);

        selectFromRegion.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Arizona", "Bay Area California", "Texas" }));

        selectToRegion.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Arizona", "Bay Area California", "Texas" }));

        loadedVehiclesTable.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null, null, null},
                {null, null, null, null, null, null},
                {null, null, null, null, null, null},
                {null, null, null, null, null, null}
            },
            new String [] {
                "LOAD/UNLOAD", "VIN", "Year", "Make", "Model", "Size"
            }
        ) {
            Class[] types = new Class [] {
                java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class
            };

            public Class getColumnClass(int columnIndex) {
                return types [columnIndex];
            }
        });
        jScrollPane5.setViewportView(loadedVehiclesTable);

        jLabel7.setFont(new java.awt.Font("Times New Roman", 1, 14)); // NOI18N
        jLabel7.setText("Loaded Vehicles");

        jLabel8.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        jLabel8.setText("Region To:");

        jLabel9.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        jLabel9.setText("Region From:");

        jLabel10.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        jLabel10.setText("Order Results:");

        selectedDriver.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Charlie Pride", "Garth Brooks", "Buck Owens", "George Strait", "ELvis Presley", "Hank Snow", "Don Gibson", "Gene Autry", "Roy Rogers", "Gene Watson", "Clint Eastwood", "Jeff Bridges", "Walter Brenan", "Gwyneth Paltrow", "Woody Harrelson", "Tim McGraw", "Garrett Hedlund", "Gary LeVox", "Jay DeMarcus", "Joe Rooney" }));

        jLabel12.setFont(new java.awt.Font("Times New Roman", 1, 14)); // NOI18N
        jLabel12.setText("Selected Driver");

        loadOut.setFont(new java.awt.Font("Tahoma", 1, 18)); // NOI18N
        loadOut.setText("LOAD OUT");

        jLabel4.setFont(new java.awt.Font("Times New Roman", 1, 14)); // NOI18N
        jLabel4.setText("Selected Trailer");

        selectedTrailer.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Item 1", "Item 2", "Item 3", "Item 4" }));

        trailersTable.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null, null, null},
                {null, null, null, null, null, null},
                {null, null, null, null, null, null},
                {null, null, null, null, null, null}
            },
            new String [] {
                "Region", "Address", "Trailer ID", "Available compact", "Available mid-sized", "Available full-sized"
            }
        ) {
            Class[] types = new Class [] {
                java.lang.String.class, java.lang.String.class, java.lang.Integer.class, java.lang.String.class, java.lang.String.class, java.lang.String.class
            };

            public Class getColumnClass(int columnIndex) {
                return types [columnIndex];
            }
        });
        trailersTable.setToolTipText("");
        jScrollPane2.setViewportView(trailersTable);

        driversTable.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null, null},
                {null, null, null, null, null},
                {null, null, null, null, null},
                {null, null, null, null, null}
            },
            new String [] {
                "Driver", "Driver ID", "Trailer ID", "Region", "Address"
            }
        ) {
            Class[] types = new Class [] {
                java.lang.String.class, java.lang.Integer.class, java.lang.String.class, java.lang.String.class, java.lang.String.class
            };

            public Class getColumnClass(int columnIndex) {
                return types [columnIndex];
            }
        });
        jScrollPane3.setViewportView(driversTable);

        bolVehiclesTable.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null, null},
                {null, null, null, null, null},
                {null, null, null, null, null},
                {null, null, null, null, null}
            },
            new String [] {
                "VIN", "Year", "Make", "Model", "Size"
            }
        ) {
            Class[] types = new Class [] {
                java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class
            };

            public Class getColumnClass(int columnIndex) {
                return types [columnIndex];
            }
        });
        bolVehiclesTable.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                bolVehiclesTableMouseClicked(evt);
            }
        });
        jScrollPane7.setViewportView(bolVehiclesTable);

        jLabel3.setFont(new java.awt.Font("Times New Roman", 1, 14)); // NOI18N
        jLabel3.setText("Selected BOL's Vehicles");

        javax.swing.GroupLayout ListedPanelLayout = new javax.swing.GroupLayout(ListedPanel);
        ListedPanel.setLayout(ListedPanelLayout);
        ListedPanelLayout.setHorizontalGroup(
            ListedPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(ListedPanelLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(ListedPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(loadOut)
                    .addGroup(ListedPanelLayout.createSequentialGroup()
                        .addGroup(ListedPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(ListedPanelLayout.createSequentialGroup()
                                .addComponent(jLabel2, javax.swing.GroupLayout.PREFERRED_SIZE, 205, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGap(18, 18, 18)
                                .addComponent(getListedBOLs))
                            .addGroup(ListedPanelLayout.createSequentialGroup()
                                .addGap(46, 46, 46)
                                .addGroup(ListedPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addGroup(ListedPanelLayout.createSequentialGroup()
                                        .addComponent(jLabel10)
                                        .addGap(134, 134, 134)
                                        .addComponent(jLabel9)
                                        .addGap(18, 18, 18)
                                        .addComponent(selectFromRegion, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                        .addGap(31, 31, 31)
                                        .addComponent(jLabel8)
                                        .addGap(18, 18, 18)
                                        .addComponent(selectToRegion, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                                    .addGroup(ListedPanelLayout.createSequentialGroup()
                                        .addComponent(jScrollPane5, javax.swing.GroupLayout.PREFERRED_SIZE, 386, javax.swing.GroupLayout.PREFERRED_SIZE)
                                        .addGap(45, 45, 45)
                                        .addComponent(jScrollPane3, javax.swing.GroupLayout.PREFERRED_SIZE, 442, javax.swing.GroupLayout.PREFERRED_SIZE))
                                    .addGroup(ListedPanelLayout.createSequentialGroup()
                                        .addComponent(jLabel7, javax.swing.GroupLayout.PREFERRED_SIZE, 125, javax.swing.GroupLayout.PREFERRED_SIZE)
                                        .addGap(306, 306, 306)
                                        .addGroup(ListedPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                            .addComponent(selectedDriver, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                            .addComponent(jLabel12)))
                                    .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 781, javax.swing.GroupLayout.PREFERRED_SIZE))))
                        .addGroup(ListedPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(ListedPanelLayout.createSequentialGroup()
                                .addGap(38, 38, 38)
                                .addComponent(jScrollPane7, javax.swing.GroupLayout.PREFERRED_SIZE, 578, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addGroup(ListedPanelLayout.createSequentialGroup()
                                .addGap(65, 65, 65)
                                .addComponent(jLabel3))
                            .addGroup(ListedPanelLayout.createSequentialGroup()
                                .addGap(22, 22, 22)
                                .addGroup(ListedPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(selectedTrailer, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addComponent(jLabel4, javax.swing.GroupLayout.PREFERRED_SIZE, 101, javax.swing.GroupLayout.PREFERRED_SIZE)))
                            .addGroup(ListedPanelLayout.createSequentialGroup()
                                .addGap(18, 18, 18)
                                .addComponent(jScrollPane2, javax.swing.GroupLayout.PREFERRED_SIZE, 580, javax.swing.GroupLayout.PREFERRED_SIZE)))))
                .addContainerGap(410, Short.MAX_VALUE))
        );
        ListedPanelLayout.setVerticalGroup(
            ListedPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(ListedPanelLayout.createSequentialGroup()
                .addGroup(ListedPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(ListedPanelLayout.createSequentialGroup()
                        .addContainerGap()
                        .addGroup(ListedPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel2)
                            .addComponent(getListedBOLs)))
                    .addComponent(loadOut))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 18, Short.MAX_VALUE)
                .addGroup(ListedPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addGroup(ListedPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(jLabel10)
                        .addComponent(jLabel9)
                        .addComponent(selectFromRegion, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(ListedPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(selectToRegion, javax.swing.GroupLayout.PREFERRED_SIZE, 20, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(jLabel8)
                        .addComponent(jLabel3)))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(ListedPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(jScrollPane1, javax.swing.GroupLayout.DEFAULT_SIZE, 195, Short.MAX_VALUE)
                    .addComponent(jScrollPane7, javax.swing.GroupLayout.PREFERRED_SIZE, 0, Short.MAX_VALUE))
                .addGap(43, 43, 43)
                .addGroup(ListedPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel12)
                    .addComponent(jLabel4)
                    .addComponent(jLabel7, javax.swing.GroupLayout.PREFERRED_SIZE, 17, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(ListedPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(selectedDriver, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(selectedTrailer, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGroup(ListedPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(ListedPanelLayout.createSequentialGroup()
                        .addGap(7, 7, 7)
                        .addComponent(jScrollPane5, javax.swing.GroupLayout.PREFERRED_SIZE, 172, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(ListedPanelLayout.createSequentialGroup()
                        .addGap(18, 18, 18)
                        .addGroup(ListedPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jScrollPane2, javax.swing.GroupLayout.PREFERRED_SIZE, 172, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jScrollPane3, javax.swing.GroupLayout.PREFERRED_SIZE, 172, javax.swing.GroupLayout.PREFERRED_SIZE))))
                .addGap(269, 269, 269))
        );

        jTabbedPane5.addTab("Listed", ListedPanel);

        jLabel6.setFont(new java.awt.Font("Tahoma", 1, 18)); // NOI18N
        jLabel6.setText("ASSIGNED BOlS");

        jTable4.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null}
            },
            new String [] {
                "Driver", "BOL ID", "Status", "Number Vehicles", "Pickup Name", "Pickup Address", "Dropoff Name", "Dropoff Address"
            }
        ) {
            Class[] types = new Class [] {
                java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class
            };

            public Class getColumnClass(int columnIndex) {
                return types [columnIndex];
            }
        });
        jScrollPane4.setViewportView(jTable4);

        isActiveBOLs.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        isActiveBOLs.setText("Active(Not delivered) BOLs");
        isActiveBOLs.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                isActiveBOLsActionPerformed(evt);
            }
        });

        jLabel11.setFont(new java.awt.Font("Tahoma", 1, 18)); // NOI18N
        jLabel11.setText("Vehicles");

        jTable6.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null}
            },
            new String [] {
                "VIN", "Year", "Make", "Model"
            }
        ) {
            Class[] types = new Class [] {
                java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class
            };
            boolean[] canEdit = new boolean [] {
                false, false, false, false
            };

            public Class getColumnClass(int columnIndex) {
                return types [columnIndex];
            }

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        jScrollPane6.setViewportView(jTable6);
        if (jTable6.getColumnModel().getColumnCount() > 0) {
            jTable6.getColumnModel().getColumn(0).setResizable(false);
            jTable6.getColumnModel().getColumn(1).setResizable(false);
            jTable6.getColumnModel().getColumn(2).setResizable(false);
            jTable6.getColumnModel().getColumn(3).setResizable(false);
        }

        getPastBOLVehicles.setFont(new java.awt.Font("DialogInput", 0, 11)); // NOI18N
        getPastBOLVehicles.setText("Get BOL's Vehicles");
        getPastBOLVehicles.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                getPastBOLVehiclesActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout BOLPanelLayout = new javax.swing.GroupLayout(BOLPanel);
        BOLPanel.setLayout(BOLPanelLayout);
        BOLPanelLayout.setHorizontalGroup(
            BOLPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(BOLPanelLayout.createSequentialGroup()
                .addGap(54, 54, 54)
                .addGroup(BOLPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jScrollPane6, javax.swing.GroupLayout.PREFERRED_SIZE, 893, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGroup(BOLPanelLayout.createSequentialGroup()
                        .addComponent(jLabel11)
                        .addGap(28, 28, 28)
                        .addComponent(getPastBOLVehicles))
                    .addComponent(jScrollPane4, javax.swing.GroupLayout.PREFERRED_SIZE, 923, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGroup(BOLPanelLayout.createSequentialGroup()
                        .addComponent(jLabel6)
                        .addGap(66, 66, 66)
                        .addComponent(isActiveBOLs, javax.swing.GroupLayout.PREFERRED_SIZE, 223, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addContainerGap(978, Short.MAX_VALUE))
        );
        BOLPanelLayout.setVerticalGroup(
            BOLPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(BOLPanelLayout.createSequentialGroup()
                .addGap(29, 29, 29)
                .addGroup(BOLPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel6)
                    .addComponent(isActiveBOLs))
                .addGap(24, 24, 24)
                .addComponent(jScrollPane4, javax.swing.GroupLayout.PREFERRED_SIZE, 192, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(BOLPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel11)
                    .addComponent(getPastBOLVehicles))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(jScrollPane6, javax.swing.GroupLayout.PREFERRED_SIZE, 259, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(256, Short.MAX_VALUE))
        );

        jTabbedPane5.addTab("Place Order", BOLPanel);

        javax.swing.GroupLayout ExportImportPanelLayout = new javax.swing.GroupLayout(ExportImportPanel);
        ExportImportPanel.setLayout(ExportImportPanelLayout);
        ExportImportPanelLayout.setHorizontalGroup(
            ExportImportPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 1955, Short.MAX_VALUE)
        );
        ExportImportPanelLayout.setVerticalGroup(
            ExportImportPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 829, Short.MAX_VALUE)
        );

        jTabbedPane5.addTab("Export/Import", ExportImportPanel);

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jTabbedPane5)
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jTabbedPane5)
                .addContainerGap())
        );

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void getPastBOLVehiclesActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_getPastBOLVehiclesActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_getPastBOLVehiclesActionPerformed

    private void isActiveBOLsActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_isActiveBOLsActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_isActiveBOLsActionPerformed

    private void getListedBOLsActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_getListedBOLsActionPerformed
        //THIS GETS LISTED BOLS IN LIST TAB BY FROM AND TO REGION
        String selectedFrom = selectFromRegion.getSelectedItem().toString();
        String selectedTo = selectToRegion.getSelectedItem().toString();
        System.out.println("selectedFrom=" + selectedFrom + ", selectedTo=" + selectedTo);
        String bolSQL = "select '0' as \"LOAD/UNLOAD\", "
                + "MIN(L1.Name) as \"From Name\", MIN(L1.Address) as \"From Address\", "
                + "MIN(L2.Name) as \"To Name\",MIN(L2.Address) as \"To Address\", COUNT(V.VIN) as \"# VEHICLES\" from "
                + "(((kdkh_order O inner join kdkh_location L1 on O.P_ID=L1.LocID) inner join kdkh_location L2 on O.D_ID=L2.LocID) "
                + "inner join kdkh_vehicle V on O.OrdID=V.OrdID) where "
                + "L1.Region='" + selectedFrom + "' and L2.Region='" + selectedTo + "' group by "
                + "L1.LocID, L2.LocID";
        //String bolSQL = "select Name,Address from location";        
        selectedTable = "bolsTable";
        bolsTableModel = new ResultSetTableModel(bolSQL);
        //sorter = new TableRowSorter(bolTableModel);
        bolsTable.setModel(bolsTableModel);
        bolsTable.getColumnModel().getColumn(0).setCellRenderer(cellRenderer);
        bolsLoaded.clear();
        for (int i = 0; i < bolsTableModel.getRowCount(); i++) {
            bolsLoaded.add("LOAD");
        }
        int number_vehicles;
        vehiclesLoaded.clear();
        System.out.println("bolsTableModel row count=" + bolsTableModel.getRowCount());
        for (int r = 0; r < bolsTableModel.getRowCount(); r++) {
            number_vehicles = Integer.parseInt(bolsTable.getValueAt(r, 5).toString());
            System.out.println("number vehicles=" + number_vehicles);
            vehiclesLoaded.add(new ArrayList<String>());
            for (int v = 0; v < number_vehicles; v++) {
                vehiclesLoaded.get(r).add("LOAD");
            }
        }
        bolsTableReady = true;
    }//GEN-LAST:event_getListedBOLsActionPerformed

    public String getBolsLoaded(int row) throws SQLException {
        return bolsLoaded.get(row);
    }

    public String getVehiclesLoaded(int bol, int vehicle) throws SQLException {
        return vehiclesLoaded.get(bol).get(vehicle);
    }

    public void loadDrivers() {
                
        String driversSQL = "select D.FName || ' ' || D.LName as \"Driver\", L.Region as \"Region\", L.Address as \"Address\""
                + "from ((kdkh_driver D inner join kdkh_trailer T on D.DriID=T.DriID) inner join kdkh_location L on L.LocID=T.LocID)";
        driversTableModel = new ResultSetTableModel(driversSQL);
        driversTable.setModel(driversTableModel);
        selectedTable = "driversTable";
        
    }

    public void loadTrailers() {
        
        String trailersSQL = "select D.FName || ' ' || D.LName as \"Driver\", L.Region as \"Region\", L.Address as \"Address\" "
                + "from ((kdkh_driver D inner join kdkh_trailer T on D.DriID=T.DriID) inner join kdkh_location L on L.LocID=T.LocID)";
        trailersTableModel = new ResultSetTableModel(trailersSQL);
        trailersTable.setModel(trailersTableModel);
        selectedTable = "trailersTable";
        
    }


    private void bolsTableMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_bolsTableMouseClicked
        // TODO add your handling code here:        
        int row = bolsTable.rowAtPoint(evt.getPoint());
        int col = bolsTable.columnAtPoint(evt.getPoint());
        if (row == selectedBOLRow || bolsTable.getRowCount() == 0 || bolsTableReady == false) {
            canGetValue = false;
            return;
        }
        canGetValue = true;
        selectedBOLRow = row;
        selectedBOLIndex = row;
        System.out.println("bolTable row=" + row + ", col=" + col);
        if (col > 0) {
            String FName = bolsTable.getValueAt(row, 1).toString();
            String TName = bolsTable.getValueAt(row, 3).toString();
            System.out.println("FName=" + FName + ", TName=" + TName);
            String bolVehiclesSQL = "SELECT '0' as \"LOAD/UNLOAD\", V.Vin, V.\"Year\", V.Make, V.Model FROM "
                    + "(((kdkh_vehicle V natural join kdkh_order O) inner join "
                    + "kdkh_location L1 on O.P_ID=L1.LocID) inner join kdkh_location L2 on O.D_ID=L2.LocID) "
                    + "where L1.Name='" + FName + "' and L2.Name='" + TName + "'";
            bolVehiclesTableModel = new ResultSetTableModel(bolVehiclesSQL);
            //sorter = new TableRowSorter(bolTableModel);            
            selectedTable = "bolVehiclesTable";
            bolVehiclesTable.setModel(bolVehiclesTableModel);
            bolVehiclesTable.getColumnModel().getColumn(0).setCellRenderer(cellRenderer);
            bolsTable.setColumnSelectionInterval(1, bolsTable.getColumnCount() - 1);
        } else if (col == 0) {//IF LOAD/UNLOAD BUTTON CLICKED....
            System.out.println("CLICKED LOAD/UNLOAD BOL!!! bolsLoaded=" + bolsLoaded.get(row));
            if (bolsLoaded.get(row).equals("LOAD")) {
                bolsLoaded.set(row, "UNLOAD");
            } else if (bolsLoaded.get(row).equals("UNLOAD")) {
                bolsLoaded.set(row, "LOAD");
            }
            selectedTable = "bolsTable";
            bolsTable.setModel(bolsTableModel);
            bolsTable.clearSelection();
        }
    }//GEN-LAST:event_bolsTableMouseClicked

    private void bolVehiclesTableMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_bolVehiclesTableMouseClicked
        // TODO add your handling code here:        
        int row = bolVehiclesTable.rowAtPoint(evt.getPoint());
        int col = bolVehiclesTable.columnAtPoint(evt.getPoint());
        System.out.println("bolVehiclesTable row=" + row + ", col=" + col);
        if (col == 0) {//IF LOAD/UNLOAD BUTTON CLICKED....
            System.out.println("CLICKED LOAD/UNLOAD VEHICLE!!! vehiclesLoaded=" + vehiclesLoaded.get(selectedBOLIndex).get(row));
            if (vehiclesLoaded.get(selectedBOLIndex).get(row).equals("LOAD")) {
                vehiclesLoaded.get(selectedBOLIndex).set(row, "UNLOAD");              
                //Vin, Year,Make, Model, Type,BOL_ID...
                loadedVehiclesTable.setValueAt(selectedBOLRow + " UNLOAD",loadedVehiclesNextIndex,0);
                loadedVehiclesTable.setValueAt(bolVehiclesTable.getValueAt(row, 1).toString(),loadedVehiclesNextIndex,1);
                loadedVehiclesTable.setValueAt(bolVehiclesTable.getValueAt(row, 2).toString(),loadedVehiclesNextIndex,2);
                loadedVehiclesTable.setValueAt(bolVehiclesTable.getValueAt(row, 3).toString(),loadedVehiclesNextIndex,3);
                loadedVehiclesTable.setValueAt(bolVehiclesTable.getValueAt(row, 4).toString(),loadedVehiclesNextIndex,4);
                loadedVehiclesNextIndex++;
                selectedTable = "loadedVehiclesTable";
                /*
                loadedVehiclesList.get(loadedVehiclesList.size()-1).add(bolVehiclesTable.getValueAt(row, 1).toString());
                loadedVehiclesList.get(loadedVehiclesList.size()-1).add(bolVehiclesTable.getValueAt(row, 2).toString());
                loadedVehiclesList.get(loadedVehiclesList.size()-1).add(bolVehiclesTable.getValueAt(row, 3).toString());
                loadedVehiclesList.get(loadedVehiclesList.size()-1).add(bolVehiclesTable.getValueAt(row, 4).toString());
                */
            } else if (vehiclesLoaded.get(selectedBOLIndex).get(row).equals("UNLOAD")) {
                vehiclesLoaded.get(selectedBOLIndex).set(row, "LOAD");
            }
            selectedTable = "bolVehiclesTable";
            bolVehiclesTable.setModel(bolVehiclesTableModel);
        }

    }//GEN-LAST:event_bolVehiclesTableMouseClicked

    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(CvatJFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(CvatJFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(CvatJFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(CvatJFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>

        /* Create and display the form */
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                cvatJFrame = new CvatJFrame();
                cvatJFrame.setVisible(true);
            }
        });

    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JPanel BOLPanel;
    private javax.swing.JPanel ExportImportPanel;
    private javax.swing.JPanel ListedPanel;
    private javax.swing.JTable bolVehiclesTable;
    private javax.swing.JTable bolsTable;
    private javax.swing.JTable driversTable;
    private javax.swing.JButton getListedBOLs;
    private javax.swing.JButton getPastBOLVehicles;
    private javax.swing.JCheckBox isActiveBOLs;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel10;
    private javax.swing.JLabel jLabel11;
    private javax.swing.JLabel jLabel12;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JLabel jLabel7;
    private javax.swing.JLabel jLabel8;
    private javax.swing.JLabel jLabel9;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JScrollPane jScrollPane2;
    private javax.swing.JScrollPane jScrollPane3;
    private javax.swing.JScrollPane jScrollPane4;
    private javax.swing.JScrollPane jScrollPane5;
    private javax.swing.JScrollPane jScrollPane6;
    private javax.swing.JScrollPane jScrollPane7;
    private javax.swing.JTabbedPane jTabbedPane1;
    private javax.swing.JTabbedPane jTabbedPane2;
    private javax.swing.JTabbedPane jTabbedPane5;
    private javax.swing.JTable jTable4;
    private javax.swing.JTable jTable6;
    private javax.swing.JButton loadOut;
    private javax.swing.JTable loadedVehiclesTable;
    private javax.swing.JComboBox<String> selectFromRegion;
    private javax.swing.JComboBox<String> selectToRegion;
    private javax.swing.JComboBox<String> selectedDriver;
    private javax.swing.JComboBox<String> selectedTrailer;
    private javax.swing.JTable trailersTable;
    // End of variables declaration//GEN-END:variables
}
